/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t,n){"function"==typeof define&&define.amd?define(["crypto-js/core","crypto-js/aes"],n):n(t.CryptoJS)}(this,function(s){(r=s.hasOwnProperty("ext")?s.ext:s.ext={}).bitshift=function(t,n){var i,e=0,s=t.words,r=0;if(0<n){for(;31<n;)s.splice(0,1),s.push(0),n-=32,r++;if(0==n)return e;for(var o=s.length-r-1;0<=o;o--)i=s[o],s[o]<<=n,s[o]|=e,e=i>>>32-n}else if(n<0){for(;n<-31;)s.splice(0,0,0),s.length--,n+=32,r++;if(0==n)return e;for(var f=(1<<(n=-n))-1,o=r;o<s.length;o++)i=s[o]&f,s[o]>>>=n,s[o]|=e,e=i<<32-n}return e},r.neg=function(t){for(var n=t.words,i=0;i<n.length;i++)n[i]=~n[i];return t},r.xor=function(t,n){for(var i=0;i<t.words.length;i++)t.words[i]^=n.words[i];return t},r.bitand=function(t,n){for(var t=t.clone(),i=t.words,e=n.words,s=0;s<i.length;s++)i[s]&=e[s];return t},r=s.hasOwnProperty("ext")?s.ext:s.ext={};var t=s.lib.Base,o=s.lib.WordArray,t=(r.const_Zero=new o.init([0,0,0,0]),r.const_One=new o.init([0,0,0,1]),r.const_Rb=new o.init([0,0,0,135]),r.const_Rb_Shifted=new o.init([2147483648,0,0,67]),r.const_nonMSB=new o.init([4294967295,4294967295,2147483647,2147483647]),r.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},s.pad.OneZeroPadding={pad:function(t,n){for(var n=4*n,i=n-t.sigBytes%n,e=[],s=0;s<i;s+=4){var r=0===s?2147483648:0;e.push(r)}n=new o.init(e,i);t.concat(n)},unpad:function(){}},s.pad.NoPadding={pad:function(){},unpad:function(){}},r.leftmostBytes=function(t,n){t=t.clone();return t.sigBytes=n,t.clamp(),t},r.rightmostBytes=function(t,n){t.clamp();var i,t=t.clone(),n=8*(t.sigBytes-n);return 32<=n&&(n-=32*(i=Math.floor(n/32)),t.words.splice(0,i),t.sigBytes-=32*i/8),0<n&&(r.bitshift(t,n),t.sigBytes-=n/8),t},r.popWords=function(t,n){var i=t.words.splice(0,n);return t.sigBytes-=4*n,new o.init(i)},r.shiftBytes=function(t,n){for(var i=(n=n||16)%4,e=(n-=i,new o.init),s=0;s<n;s+=4)e.words.push(t.words.shift()),t.sigBytes-=4,e.sigBytes+=4;return 0<i&&(e.words.push(t.words[0]),e.sigBytes+=i,r.bitshift(t,8*i),t.sigBytes-=i),e},r.xorendBytes=function(t,n){return r.leftmostBytes(t,t.sigBytes-n.sigBytes).concat(r.xor(r.rightmostBytes(t,n.sigBytes),n))},r.dbl=function(t){var n=r.msb(t);return r.bitshift(t,1),r.xor(t,1===n?r.const_Rb:r.const_Zero),t},r.inv=function(t){var n=1&t.words[4];return r.bitshift(t,-1),r.xor(t,1==n?r.const_Rb_Shifted:r.const_Zero),t},r.equals=function(t,n){if(!n||!n.words||t.sigBytes!==n.sigBytes)return!1;t.clamp(),n.clamp();for(var i=0,e=0;e<t.words.length;e++)i|=t.words[e]^n.words[e];return 0===i},r.msb=function(t){return t.words[0]>>>31},s.lib.Base),o=s.lib.WordArray,e=s.algo.AES,r=s.ext,f=s.pad.OneZeroPadding,i=s.algo.CMAC=t.extend({init:function(t){this._aes=e.createEncryptor(t,{iv:new o.init,padding:s.pad.NoPadding});var n,t=this._aes.finalize(r.const_Zero),i=t.clone();r.dbl(i),this._isTwo?(n=t.clone(),r.inv(n)):(n=i.clone(),r.dbl(n)),this._K1=i,this._K2=n,this._const_Bsize=16,this.reset()},reset:function(){this._x=r.const_Zero.clone(),this._counter=0,this._buffer=new o.init},update:function(t){if(t){var n=this._buffer,i=this._const_Bsize;for("string"==typeof t&&(t=s.enc.Utf8.parse(t)),n.concat(t);n.sigBytes>i;){var e=r.shiftBytes(n,i);r.xor(this._x,e),this._x.clamp(),this._aes.reset(),this._x=this._aes.finalize(this._x),this._counter++}}return this},finalize:function(t){this.update(t);var t=this._buffer,n=this._const_Bsize,i=t.clone();return t.sigBytes===n?r.xor(i,this._K1):(f.pad(i,n/4),r.xor(i,this._K2)),r.xor(i,this._x),this.reset(),this._aes.reset(),this._aes.finalize(i)},_isTwo:!1});s.CMAC=function(t,n){return i.create(t).finalize(n)},s.algo.OMAC1=i,s.algo.OMAC2=i.extend({_isTwo:!0})});