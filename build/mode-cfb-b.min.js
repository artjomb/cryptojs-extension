/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(e,r){"function"==typeof define&&define.amd?define(["crypto-js/core","crypto-js/cipher-core"],r):r(e.CryptoJS)}(this,function(e){var r=e.hasOwnProperty("ext")?e.ext:e.ext={},r=(r.bitshift=function(e,r){var t,o=0,n=e.words,i=0;if(0<r){for(;31<r;)n.splice(0,1),n.push(0),r-=32,i++;if(0==r)return o;for(var s=n.length-i-1;0<=s;s--)t=n[s],n[s]<<=r,n[s]|=o,o=t>>>32-r}else if(r<0){for(;r<-31;)n.splice(0,0,0),n.length--,r+=32,i++;if(0==r)return o;for(var c=(1<<(r=-r))-1,s=i;s<n.length;s++)t=n[s]&c,n[s]>>>=r,n[s]|=o,o=t<<32-r}return o},r.neg=function(e){for(var r=e.words,t=0;t<r.length;t++)r[t]=~r[t];return e},r.xor=function(e,r){for(var t=0;t<e.words.length;t++)e.words[t]^=r.words[t];return e},r.bitand=function(e,r){for(var e=e.clone(),t=e.words,o=r.words,n=0;n<t.length;n++)t[n]&=o[n];return e},e.lib.BlockCipherMode.extend()),a=e.lib.WordArray,x=e.ext.bitshift,m=e.ext.neg;function t(e,r,t){for(var o=this,n=o._cipher,i=32*n.blockSize,s=o._prevBlock,c=n.cfg.segmentSize,l=[],f=31;f<c;f+=32)l.push(4294967295);for(l.push((1<<c)-1<<32-c),f=l.length;f<e.length;f++)l.push(0);var h,p=(l=new a.init(l)).clone(),d=p.clone();for(x(d,32*-r),f=0;f<i/c;f++){if(s){for(s=new a.init(s),x(s,c),s=s.words,previousCiphertextSegment=o._ct;previousCiphertextSegment.length<i/32;)previousCiphertextSegment.push(0);previousCiphertextSegment=new a.init(previousCiphertextSegment),x(previousCiphertextSegment,-i+c);for(var u=0;u<s.length;u++)s[u]|=previousCiphertextSegment.words[u]}else s=o._iv.slice(0),o._iv=void 0;var g=32*r+f*c,v=new a.init(e.slice(0)),w=(x(v,g),t||(o._ct=v.words.slice(0,Math.ceil(c/32))),s.slice(0));for(n.encryptBlock(w,0),u=0;u<Math.ceil(c/32);u++)v.words[u]^=w[u];for(u=0;u<v.words.length;u++)v.words[u]&=l.words[u];for(t&&(o._ct=v.words.slice(0,Math.ceil(c/32))),h=m(d.clone()),u=0;u<e.length;u++)e[u]&=h.words[u];for(x(v,-g),u=0;u<e.length;u++)e[u]|=v.words[u];x(p,-c),x(d,-c)}o._prevBlock=s}r.Encryptor=r.extend({processBlock:function(e,r){t.call(this,e,r,!0)}}),r.Decryptor=r.extend({processBlock:function(e,r){t.call(this,e,r,!1)}}),e.mode.CFBb=r});